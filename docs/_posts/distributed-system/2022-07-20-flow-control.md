常用的流控方式，包括滑动窗口，漏桶，令牌桶。滑动窗口主要是用来控制client端的发送速率，即窗口没有滑动之前，不能发送后面的数据。与漏桶和令牌桶的作用时机不同，不冲突，可以结合使用。

- 漏桶：桶具有一定容量，固定的流出速率，水来了之后先进桶，慢慢流出。
- 令牌桶：桶里有一定数量的令牌，水来了拿个令牌就可以流出了，不会阻塞在桶里慢慢等。产生令牌的速度是一定的。比较的话，一般会说，令牌桶可以更好应付短时大流量。

一般流控控制的指标，就是qps和并发。以控制内存开销情况，也可以转换成对qps的限制，每个写请求都会另外开辟内存，而读请求因为不可能命中内存cache，所以也一定会开辟内存。

同时，令牌桶往往有个冷启动的过程，避免qps突然达到峰值。即当桶内剩余令牌数量超过某个warning时，那么最大qps会被限制，剩余令牌数量越少，则最大qps越大，直到达到设定的阈值。